<% content_for :javascript do %>
<script type="text/javascript">
  var eventName = typeof(Turbolinks) !== 'undefined' ? 'turbolinks:load' : 'DOMContentLoaded';

  if (!document.documentElement.hasAttribute("data-turbolinks-preview")) {
    document.addEventListener(eventName, function flash() {
      <% if flash[:notice] %>
        SpiffyStoresApp.flashNotice(<%== flash[:notice].to_json %>);
      <% end %>

      <% if flash[:error] %>
        SpiffyStoresApp.flashError(<%== flash[:error].to_json %>);
      <% end %>

      document.removeEventListener(eventName, flash)
    });
  }
</script>
<% end %>
